#!/bin/bash

docker tag -f $CONTAINER:latest ${EXTERNAL_REGISTRY_BASE_DOMAIN}/${REPOSITORY_NAME}:latest
docker push ${EXTERNAL_REGISTRY_BASE_DOMAIN}/${REPOSITORY_NAME}:latest

docker tag -f $CONTAINER:latest ${EXTERNAL_REGISTRY_BASE_DOMAIN}/${REPOSITORY_NAME}:$CI_SHA1
docker push ${EXTERNAL_REGISTRY_BASE_DOMAIN}/${REPOSITORY_NAME}:$CI_SHA1

docker tag -f $CONTAINER:latest ${EXTERNAL_REGISTRY_BASE_DOMAIN}/${REPOSITORY_NAME}:$CI_BRANCH
docker push ${EXTERNAL_REGISTRY_BASE_DOMAIN}/${REPOSITORY_NAME}:$CI_BRANCH

docker tag -f $CONTAINER:latest ${EXTERNAL_REGISTRY_BASE_DOMAIN}/${REPOSITORY_NAME}:build_$CI_BUILD_NUM
docker push ${EXTERNAL_REGISTRY_BASE_DOMAIN}/${REPOSITORY_NAME}:build_$CI_BUILD_NUM
